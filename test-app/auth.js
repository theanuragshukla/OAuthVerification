function _0x5adf(){const _0x344b47=['6340KGLUiD','toString','Set-Cookie','token\x20expired','randomBytes','idToken','792jRGtML','crypto','status','http://localhost:3000/apps/authorise','config','CLIENT_ID','env','getToken','1054226peOqrm','dotenv','1002990jFLRON','data','61830MruspJ','verify','log','then','reduce','471eIjfGy','redirect','107262MnAour','getAuthURL','2361510EiBtMJ',';\x20Path=/;HttpOnly','split','query','unverfied\x20nonce','setHeader','true','REDIRECT','5790736LyAlgv','trim','getBasicProfile','catch','http://localhost:3000/get-id-token','7cwLewT','hex'];_0x5adf=function(){return _0x344b47;};return _0x5adf();}const _0x4caf2a=_0x545b;(function(_0x46e4d2,_0x4a3dff){const _0x2ab1a0=_0x545b,_0x2854dc=_0x46e4d2();while(!![]){try{const _0xae1f8d=parseInt(_0x2ab1a0(0xaf))/0x1+parseInt(_0x2ab1a0(0xa4))/0x2+-parseInt(_0x2ab1a0(0xad))/0x3*(parseInt(_0x2ab1a0(0xc0))/0x4)+parseInt(_0x2ab1a0(0xa6))/0x5+-parseInt(_0x2ab1a0(0xb1))/0x6*(parseInt(_0x2ab1a0(0xbe))/0x7)+parseInt(_0x2ab1a0(0xb9))/0x8+-parseInt(_0x2ab1a0(0xc6))/0x9*(parseInt(_0x2ab1a0(0xa8))/0xa);if(_0xae1f8d===_0x4a3dff)break;else _0x2854dc['push'](_0x2854dc['shift']());}catch(_0x30c4f1){_0x2854dc['push'](_0x2854dc['shift']());}}}(_0x5adf,0x5ae39),require(_0x4caf2a(0xa5))[_0x4caf2a(0xca)]());function _0x545b(_0x48a1f6,_0x488fa7){const _0x5adffe=_0x5adf();return _0x545b=function(_0x545bd8,_0x44b2d8){_0x545bd8=_0x545bd8-0xa1;let _0xe8fbfb=_0x5adffe[_0x545bd8];return _0xe8fbfb;},_0x545b(_0x48a1f6,_0x488fa7);}const crypto=require(_0x4caf2a(0xc7)),axios=require('axios'),CLIENT_ID=process[_0x4caf2a(0xa2)][_0x4caf2a(0xa1)],CLIENT_SECRET=process[_0x4caf2a(0xa2)]['CLIENT_SECRET'],AUTH_SERVER_URL=_0x4caf2a(0xbd),AUTH_URL=_0x4caf2a(0xc9),redirect=process[_0x4caf2a(0xa2)][_0x4caf2a(0xb8)],baseURL=process[_0x4caf2a(0xa2)]['ROOT'],jwt=require('jsonwebtoken'),generateNonce=(_0x2b262e=0x10)=>{const _0xc9eb95=_0x4caf2a,_0x15d28e=crypto[_0xc9eb95(0xc4)](_0x2b262e)[_0xc9eb95(0xc1)](_0xc9eb95(0xbf));return _0x15d28e;},getcookie=_0x1516e9=>{const _0x3a8dbf=_0x4caf2a,{headers:{cookie:_0x37aa4d}}=_0x1516e9;return _0x37aa4d['split'](';')[_0x3a8dbf(0xac)]((_0x8fca3f,_0xa0362d)=>{const _0x34156b=_0x3a8dbf,_0xb5e03c=_0xa0362d[_0x34156b(0xba)]()[_0x34156b(0xb3)]('=');return{..._0x8fca3f,[_0xb5e03c[0x0]]:_0xb5e03c[0x1]};},{});},requestIdToken=async _0x53f061=>{const _0x222467=_0x4caf2a;let _0x158959=null;return await axios['post'](AUTH_SERVER_URL,{'code':_0x53f061,'client_id':CLIENT_ID,'client_secret':CLIENT_SECRET})[_0x222467(0xab)](_0x2b8ff7=>{const _0x3bbe73=_0x222467;_0x158959=_0x2b8ff7[_0x3bbe73(0xa7)]['token'];})[_0x222467(0xbc)](_0xd67893=>{const _0x1eec7b=_0x222467;console[_0x1eec7b(0xaa)](_0xd67893);}),_0x158959;};exports[_0x4caf2a(0xb0)]=async _0x2d3bbf=>{const _0x2cbd92=_0x4caf2a,_0x15deb4=generateNonce(),_0x4a2921={'client_id':CLIENT_ID,'redirect':''+baseURL+redirect,'nonce':_0x15deb4,'getBasicProfile':!![]};var _0x3a098e=new Date(Number(new Date())+0x493e0);_0x2d3bbf[_0x2cbd92(0xb6)](_0x2cbd92(0xc2),'nonce='+_0x15deb4+';expires='+_0x3a098e+_0x2cbd92(0xb2));let _0x2d81a4=AUTH_URL+'?'+new URLSearchParams(_0x4a2921)[_0x2cbd92(0xc1)]();_0x2d81a4=encodeURI(_0x2d81a4),_0x2d3bbf[_0x2cbd92(0xae)](_0x2d81a4);},exports[_0x4caf2a(0xa3)]=async _0x5bf49e=>{const _0x561183=_0x4caf2a,_0x1e6f89=_0x5bf49e[_0x561183(0xb4)],_0x577fe3=getcookie(_0x5bf49e);if(_0x577fe3['nonce']!==_0x1e6f89['nonce'])return{'status':![],'msg':_0x561183(0xb5)};const _0x55c2ec=_0x1e6f89['code'],_0x4da311=await requestIdToken(_0x55c2ec);if(_0x4da311===null)return{'status':![],'msg':'authorisation\x20code\x20already\x20used\x20or\x20expired'};if(_0x1e6f89['getBasicProfile']==_0x561183(0xb7))return{'status':!![],'profile':this[_0x561183(0xbb)](_0x4da311)};return{'status':!![],'idToken':_0x4da311};},exports[_0x4caf2a(0xbb)]=_0x4a760a=>{const _0x136b36=_0x4caf2a;try{const _0x13d2ef=jwt[_0x136b36(0xa9)](_0x4a760a,CLIENT_SECRET);return _0x13d2ef[_0x136b36(0xc8)]=!![],_0x13d2ef[_0x136b36(0xc5)]=_0x4a760a,_0x13d2ef;}catch(_0x30746b){return{'status':![],'msg':_0x136b36(0xc3)};}};
